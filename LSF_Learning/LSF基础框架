LSF学习Spectrum LSF：
    原因：
        1. 高效的集群管理系统计算机通过执行程序帮助研究，需要获取运算结果
        2. 为了提供强大的计算能力，计算资源以集群的形式出现。

LSF：
    Load Sharing Facility 分布式集群管理系统软件
    任务：
        1. 负责计算资源的管理和批处理作业的调度。
        2. 为用户提供统一的集群资源访问接口，让用户透明的访问整个集群资源，
        3. 同事提供了丰富的功能和可定制的策略。
    特性：
        1. LSF 具有良好的可伸缩性和高可用性，支持所有的主流操作系统，是高性能计算的基础软件。
        2. 基础使用使用者分为两类，普通用户和集群系统管理员。
            2.1 普通用户通过命令，将计算程序提交给集群执行，获取计算结果。
            2.2 系统管理员通过配置文件和管理命令，管理集群以及统计计算资源的使用情况普通用户提交可执行程序或脚本给LSF.

    常用命令：
        1. LSF讲这些称为作业。在Queue中排队pend，等待调度。
           提交作业：bsub -R "linux" sleep 1000

        2. LSF根据配置的调度策略，把作业分配到最合适的计算节点上执行。
           通过命令行查看，控制作业的执行过程。LSF为用户提供了作业修改，需求描述，作业控制
           lsfrhel01 # bjobs
           JOBID   USER    STAT  QUEUE      FROM_HOST   EXEC_HOST   JOB_NAME   SUBMIT_TIME1
           tom     RUN   normal     lsfrhel01   lsfrhel02   *eep 1000  May  9 15:42

        3. 系统管理员需要了解整个集群系统中作业和资源的使用状况，LSF提供的命令帮助管理员快速直观的看到系统概况
           系统队列的状态，机器的状态，作业的资源使用概况。以及集群配置，控制管理等功能
           lsfrhel01 # bqueues normal  查看normal队列信息
           QUEUE_NAME      PRIO STATUS          MAX JL/U JL/P JL/H NJOBS  PEND   RUN  SUSPnormal
           30  Open:Active       -    -    -    -     1     0     1     0
           lsfrhel01 # bhosts 查看节点信息
           HOST_NAME          STATUS       JL/U    MAX  NJOBS    RUN  SSUSP  USUSP    RSV
           lsfrhel01          ok              -      4      0      0      0      0      0
           lsfrhel02          ok              -      8      1      1      0      0
           lsfrhel01 # bacct
           SUMMARY:      ( time unit: second ) Total number of done jobs:       1
           Total number of exited jobs:     4 Total CPU time consumed:       4.4
           Average CPU time consumed:为了提供强大的计算能力，计算资源以集群的形式出现。     0.9 Maximum CPU time of a job:     4.3
           Minimum CPU time of a job:     0.0 Total wait time in queues: 276962.0

    基础概念：
    节点：LSF是资源管理的工具，管理机器，作业和用户集群中的机器是对等的，称为服务节点Server Host。
         即可以提交作业，也可以执行作业。
         1. 服务节点可以有不同的身份，管理作业调度资源的节点称为主节点Master host, 一个集群只有一个主节点。
         2. 提交作业的节点为提交节点Submission host，被分配并执行作业的节点是执行节点 Execution host
    节点组的概念：1. 任意的机器集合可以被作为整体命名，在集群范围内整体引用。
                典型的用法为将节点按照分类为：大内存节点组和小内存节点组，不同的作业请求不同的节点组。
                为方便管理，同一机器定义到不同的节点组作业占用及其资源进行计算。

                2. 每个机器分为不同槽位，每个槽位可以容纳一个作业运行。通常情况下一个槽位和一个CPU核心相对应。
                对于并行作业，例如MPI作业，每一个都需要占用更多的槽位加速计算。

    作业的管理：以队列为单位的，调度的策略也是按照队列定制的。
              可以配置多个队列定制不同策略。按照队列的优先级，从高到低调度每一个队列中的作业，为其分配资源。

    用户组的概念：人是作业提交者也是资源使用者，亿用户为单位，设置用户组体系结构

    客户机服务器模式：主节点负责整个集群的管理，节点负责管理运行其上的作业的管理。
    节点上的线程：
        1. Sbatchd：批处理作业管理进程，负责本节点上执行作业，监控作业状态，收集其使用的资源。
           根据用户请求或者系统策略触发，控制作业状态，发送SIGSTOP挂起作业
        2. RES: 远程执行服务进程，负责执行远程客户请求的任务，主要用于并行作业的远程任务启动，监控和控制
        3. LIM: 采集本节点的负载信息，讲收集到的资源负载信息周期上报给主节点的LIM.
           主节点的LIM拥有整个集群资源状态，为其他服务提供集群系统范围内的资源的当前快照。
    主节点额外线程：
        1. Mbatchd线程，是集群管理服务进程，是LSF的中心，通过主节点的LIM获取机器以及相关资源信息，处理远程用户的作业提交请求，
           委托mbschd将作业调度到相关资源上，发送调度结果到制定机器，通过sbatchd的交互，监控作业使用的资源，控制作业的执行过程。
        2. Mbschd: 调度策略服务进程，从mbatchd获取作业和资源信息，为mbatchd提供调度服务当一个新作业提交的时候，
           集群管理服务进程检查作业的合法性，并将作业放入指定的队列中等待调度，

    经过调度的作业，将获得执行机器上的slot，内存等资源。
    LSF负责保留相关资源并将作业只拍到已分配机器上执行。
    作业的状态和实际使用的资源通过LIM报告给集群管理进程。

    集群设备构建在分布式网络节点上，节点的失效和网络设备的故障都会导致集群系统的基础环境改变。
    高可用保证在底层设备故障仍提供稳定服务。

    LSF采用主备模式实现系统的故障回复，LSF的主节点将运行时事件信息写入网络文件系统，
    当主节点失效，相关备节点进行选举，新的主节点从事件信息文件中恢复作业信息，
    机器状态最终获取集群控制权，恢复LSF状态。

    为了更进一步扩展LSF 的资源管理范围和方式，在单一集群基础上，
        LSF 还提供多集群互联技术（Multi-Cluster）。
        多集群通过互联，共享跨集群资源，提供更强大的计算能力。
        下面是一种典型的多集群架构，集群1负责接收作业提交和转发，集群2和3负责作业执行。

    资源调度LSF收集每一个节点的处理器，内存，交换区，临时存储区等资源信息。
    主节点掌握全局资源信息。资源的管理和调度以这些信息为基础。
    lsfrhel01 # lshosts
    HOST_NAME      type    model  cpuf ncpus maxmem maxswp server RESOURCES
    lsfrhel01    X86_64   PC6000 116.1     2   1.4G   1.4G    Yes (mg)
    lsfrhel02    X86_64   PC6000 116.1     2   1.4G   1.4G    Yes ()
    lsfrhel01 # lsload
    HOST_NAME       status  r15s   r1m  r15m   ut    pg  ls    it   tmp   swp   mem
    lsfrhel01           ok   0.4   0.0   0.0   0%   0.0   1   179   10G  1.4G  1.1G
    lsfrhel02           ok   1.5   0.3   0.3   1%   0.1   2     1 2391M  1.2G  603M

    作业在使用资源的时候，主要考虑三个方面：
        根据作业的资源描述选择合适的执行机器，
        预留机器资源减少运行时的资源竞争，
        限制作业对资源的使用首先选择执行机，select[mem>512],
        然后确保执行机上的资源分配，需要保证作业运行时会有512M的内存分配给该作业。resage[mem=512],
        最后保证资源不被过度消耗，设置一个资源上限 -M 1024
        bsub -M 1024 -R "select[mem>512] rusage[mem=512]" sleep 1000

    对于资源的选择、预留和限制，内存只是一个例子。
        LSF 还支持很多种资源，比如CPU、交换区、临时目录大小等等。
        虽然这些默认管理的资源始终是有限的，但是LSF 还提供了资源管理的扩展机制。
        用户可以统过编写自己的ELIM 来收集自定义的资源。
        比如，收集系统的网络带宽以及网络负载，作业可以通过资源描述，选择拥有相应带宽的节点执行作业。
        资源的种类很多，LSF 提供布尔类型、字符串类型和数字类型来描述多种多样的资源。

    定制策略：FCFS 先到先得
    Fairshare 部门之间平等，
    共享并行作业，需要很多solt，需要资源保留策略，以及对应的回填策略。
    对于特殊问题，采用抢占策略获取已执行作业的资源

iSC仿真云：
总体流程：
    需求体系化
    1. 需求体系化，需求端到端 用户需求【业务方案，技术方案】
    2. 特性，用户故事【简单设计，测试用例，测试计划，测试结果】
    3. Task，软件版本，代码，代码评审结果
    CI流水线统一
    1. 统一CI与本地CI并行，互为补充
    2. 统一CI作为基础支撑，涵盖基本动作，代码检查部署
    3. 本地CI提供更多环境参数支持以及特定ci支持
    代码质量提升
    1. 结合红线要求，线上线下代码走查
    2. 线下代码通过icenter+tfs实现闭环跟踪
    3. 质量复盘（内外部复盘，版本复盘）
    测试防护网建设
    1. 测试分层，实现自动化测试
    2. 结合mergeCI，DailyCI，特性CI实现n级防护
    度量改进
    1. 基础度量+项目级定制度量
    2. 从产品愿景出发，按价值、效率、质量等方面建立项目级度量体系

中兴试验机：
    esc01.zte.com.cn 河源堡垒机 -> 正式机
    esc02.zte.com.cn 西丽 准正式，sla不考核
    esc04.zte.com.cn test
    esc05.zte.com.cn 导师搭建，报表有问题
    (esc03 算法子模块，由5G自己运维)

用户权限授予：
    进入/root/tools
    ./createuser-g.sh 10307043 daikaixuan admin
    make -C /var/yp
    rsync -av root@10.5.22.155:/share/home/10307043 /share/home/
    id 10307043
前台将对应的id放进去

配置更改各部门机器数量：
    首先修改配置文件，然后让配置文件生效
    最后在前台进行验证